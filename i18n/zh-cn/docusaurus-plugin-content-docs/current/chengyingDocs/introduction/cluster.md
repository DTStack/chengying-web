---
id: cluster
title: 集群管理
---

[![License](https://img.shields.io/badge/license-Apache%202-4EB1BA.svg)](https://www.apache.org/licenses/LICENSE-2.0.html)

## 集群管理
用户可在 "部署中心-集群管理-集群列表” 查看已添加集群及组件等信息。选择一个集群进入可查看该集群的总览信息、部署组件、部署历史等信息。
### 集群总览
**主机集群**
- CPU、内存、磁盘使用情况趋势：可通过筛选时间段查看该集群 CPU、内存、磁盘的总量及使用趋势;
- 节点状态：支持查看该集群下当前节点总数、正常节点数、异常节点数;
- 集群基本信息：包括集群模式、节点数、CPU、内存、磁盘、创建人、创建时间;
- CPU、内存使用率 TOP5 节点。
![q1](/img/usage/clusterManage.png)

### 主机资源
集群内所有主机管理，可查看主机的基础信息，包含主机IP、主机名称、部署产品组件、最近心跳时间、主机创建时间、启动用户、agent状态、主机初始化状态、主机详情等。
![q2](/img/usage/hostList.png)

**添加主机**

主机添加的操作与流程，与部署向导的主机添加一致，详见添加主机，此处不再赘述。

**主机状态**

主机状态包含agent状态和主机初始化状态。
- agent状态：表示主机现在是否处于可用状态，是否是一台存活的主机；
- 主机初始化状态：主机接入需经过管控安装到主机初始化，两步完成后主机初始化，若中间某步失败可查看失败日志。

**主机监控**

主机监控通过仪表盘展示，包含以下指标信息，可筛选主机。
![q3](/img/usage/hostGraph.png)

**主机移动**

主机中有主机分组的概念，当一个集群中主机过多时，可对主机进行分组，方便管理。主机移动指将主机移动到不同分组中。
一个主机只可出现一个分组中。
![q4](/img/usage/hostMove.png)

**主机下架**

主机agent状态为 “已停止” 时，支持删除主机，会将该主机铲掉。如主机的agent状态为 “运行中”，则不允许删除。

### 已部署组件
集群中已部署产品包汇总，以及部署历史信息查看。
![q4](/img/usage/deployedProduct.png)
#### 查看部署状态
组件列表中包含目前集群中所有的组件安装包，包含以下基础信息：
- 组件的版本号：可查看各组件的版本号，且当前部署的组件和版本用星号标识；
- 安装包上传时间与部署人；
- 组件部署状态和操作：包含以下几种部署状态，以及部署状态与操作对应关系如下：

| 部署状态 | 操作      |
|:-----|:--------|
| 未部署  | 部署/删除   |
| 部署成功 | 重新部署/卸载 |
| 部署失败 | 重新部署/卸载 |
| 部署中  | 查看部署进度  |
| 部署失败 | 重新部署/卸载 |
| 卸载中  | 查看卸载进度  |
- 未部署的产品包允许删除，若已部署则不允许删除；
- 部署中和卸载中的安装包，支持查看部署/卸载进度；
- 支持产品二次部署；
- 支持产品卸载。
#### 查看配置
查看该产品包下各服务的具体配置，且配置信息支持搜索，关键词高亮。
![q5](/img/usage/productConfig.png)
#### 重新部署
组件支持重新部署，针对部署成功、部署失败、卸载失败的组件都可二次部署。
重新部署的流程与第一次部署时一致，进入部署向导部署即可。
#### 组件卸载
已部署的组件支持卸载，卸载进行开始后不可停止，系统将按照服务依赖顺序开始卸载。
当某服务实例停止失败或卸载失败时，系统支持强制停止或强制卸载，以便整个组件可卸载完成。
支持查看每个服务的卸载日志，以便排查问题。
组件卸载成功后，状态变为 “未部署” 状态。

### 部署历史
产品部署历史的记录，方便回溯问题。
![q6](/img/usage/deployHistory.png)
部署历史中记录了该集群中的部署记录，包含如下信息：
- 组件名称和版本号
- 部署人和部署时间
- 部署状态
- 部署快照：可查看每个服务实例的部署状态
- 配置：查看部署产品包的配置文件
- 部署日志：查看此次部署的完整部署日志
通过部署历史，可审计运维人员的部署操作，并可追溯以前的部署内容、部署情况，助于现在的信息整理或部署改进。

### 补丁包
补丁包可用于紧急更新，无需制作标准产品包，即可对已部署组件进行快速更新。
#### 上传补丁包
点击 “上传补丁包” 按要求选择要更新的产品、目标服务文件、选择补丁包，完成补丁包的上传，上传后可在列表页跟进补丁包的更新进度。
![q7](/img/usage/patchPackage.png)
#### 查看快照
可查看补丁包更新的目标服务所在的主机中的更新状态。
![q8](/img/usage/patchSnapshot.png)

### 集群命令
根据产品维度对命令执行情况进行状态跟踪及日志与脚本的查看，包含以下操作类型：产品包部署、补丁包升级、产品包启动、服务启动、服务滚动重启、主机初始化、Kerberos 开启、Kerberos 关闭。点击操作可查看脚本信息及执行日志。
![q9](/img/usage/orderList.png)
![q10](/img/usage/orderDetail.png)